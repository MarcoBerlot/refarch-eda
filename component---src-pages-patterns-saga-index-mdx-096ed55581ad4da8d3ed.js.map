{"version":3,"sources":["webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/PageHeader.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/EditLink.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/PageTabs.js","webpack:///./node_modules/gatsby-theme-carbon/src/templates/Default.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/EditLink.module.scss","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/PageTabs.module.scss","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/PageHeader.module.scss","webpack:///./src/pages/patterns/saga/index.mdx"],"names":["PageHeader","title","tabs","className","cx","pageHeader","withTabs","length","id","text","EditLink","relativePagePath","repositoryProp","repository","useStaticQuery","site","siteMetadata","baseUrl","subDirectory","href","branch","row","link","PageTabs","render","this","props","slug","currentTab","split","filter","Boolean","slice","pageTabs","map","tab","slugifiedTab","slugify","lower","strict","selected","currentTabRegex","RegExp","replace","key","selectedItem","listItem","to","tabsContainer","list","React","Component","Default","pageContext","children","location","Title","frontmatter","titleType","theme","description","keywords","pathPrefix","pathname","Layout","homepage","pageTitle","pageDescription","pageKeywords","label","Main","padded","NextPrevious","Utils","module","exports","_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---src-pages-patterns-saga-index-mdx-096ed55581ad4da8d3ed.js","sourcesContent":["import PageHeader from './PageHeader';\n\nexport default PageHeader;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport { pageHeader, withTabs, text } from './PageHeader.module.scss';\n\nconst PageHeader = ({ title, tabs = [] }) => (\n  <div className={cx(pageHeader, { [withTabs]: tabs.length })}>\n    <div className=\"bx--grid\">\n      <div className=\"bx--row\">\n        <div className=\"bx--col-lg-12\">\n          <h1 id=\"page-title\" className={text}>\n            {title}\n          </h1>\n        </div>\n      </div>\n    </div>\n  </div>\n);\n\nPageHeader.propTypes = {\n  /**\n   * Specify the title for the page\n   */\n  title: PropTypes.node,\n};\n\nexport default PageHeader;\n","import EditLink from './EditLink';\n\nexport default EditLink;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { graphql, useStaticQuery } from 'gatsby';\n\nimport { link, row } from './EditLink.module.scss';\n\nconst EditLink = ({ relativePagePath, repository: repositoryProp }) => {\n  const {\n    site: {\n      siteMetadata: { repository },\n    },\n  } = useStaticQuery(graphql`\n    query REPOSITORY_QUERY {\n      site {\n        siteMetadata {\n          repository {\n            baseUrl\n            subDirectory\n            branch\n          }\n        }\n      }\n    }\n  `);\n\n  const { baseUrl, subDirectory, branch } = repositoryProp || repository;\n\n  const href = `${baseUrl}/edit/${branch}${subDirectory}/src/pages${relativePagePath}`;\n\n  return baseUrl ? (\n    <div className={`bx--row ${row}`}>\n      <div className=\"bx--col\">\n        <a className={link} href={href}>\n          Edit this page on GitHub\n        </a>\n      </div>\n    </div>\n  ) : null;\n};\n\nEditLink.propTypes = {\n  repository: PropTypes.shape({\n    baseUrl: PropTypes.string,\n    subDirectory: PropTypes.string,\n    branch: PropTypes.string,\n  }),\n  relativePagePath: PropTypes.string,\n};\n\nexport default EditLink;\n","import PageTabs from './PageTabs';\n\nexport default PageTabs;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'gatsby';\nimport slugify from 'slugify';\nimport cx from 'classnames';\n\nimport {\n  tabsContainer,\n  list,\n  selectedItem,\n  listItem,\n  link,\n} from './PageTabs.module.scss';\n\nexport default class PageTabs extends React.Component {\n  render() {\n    const { tabs, slug } = this.props;\n    const currentTab = slug.split('/').filter(Boolean).slice(-1)[0];\n\n    const pageTabs = tabs.map((tab) => {\n      const slugifiedTab = slugify(tab, { lower: true, strict: true });\n      const selected = slugifiedTab === currentTab;\n      // matches with or without trailing slash: /?\n      // matches with or without hash link: (#.*)?\n      const currentTabRegex = new RegExp(`${currentTab}/?(#.*)?$`);\n      const href = slug.replace(currentTabRegex, slugifiedTab);\n      return (\n        <li key={tab} className={cx({ [selectedItem]: selected }, listItem)}>\n          <Link className={link} to={`${href}`}>\n            {tab}\n          </Link>\n        </li>\n      );\n    });\n\n    return (\n      <div className={tabsContainer}>\n        <div className=\"bx--grid\">\n          <div className=\"bx--row\">\n            <div className=\"bx--col-lg-12 bx--col-no-gutter\">\n              <nav>\n                <ul className={list}>{pageTabs}</ul>\n              </nav>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nPageTabs.propTypes = {\n  tabs: PropTypes.array,\n  slug: PropTypes.string,\n};\n","import React from 'react';\nimport slugify from 'slugify';\nimport { useStaticQuery, graphql } from 'gatsby';\n\nimport Utils from '../components/Utils';\nimport Layout from '../components/Layout';\nimport PageHeader from '../components/PageHeader';\nimport EditLink from '../components/EditLink';\nimport NextPrevious from '../components/NextPrevious';\nimport PageTabs from '../components/PageTabs';\nimport Main from '../components/Main';\n\nconst Default = ({ pageContext, children, location, Title }) => {\n  const { frontmatter = {}, relativePagePath, titleType } = pageContext;\n  const { tabs, title, theme, description, keywords } = frontmatter;\n\n  // get the path prefix if it exists\n  const {\n    site: { pathPrefix },\n  } = useStaticQuery(graphql`\n    query PATH_PREFIX_QUERY {\n      site {\n        pathPrefix\n      }\n    }\n  `);\n\n  // let gatsby handle prefixing\n  const slug = pathPrefix\n    ? location.pathname.replace(pathPrefix, '')\n    : location.pathname;\n\n  const getCurrentTab = () => {\n    if (!tabs) return '';\n    return (\n      slug.split('/').filter(Boolean).slice(-1)[0] ||\n      slugify(tabs[0], { lower: true })\n    );\n  };\n\n  const currentTab = getCurrentTab();\n\n  return (\n    <Layout\n      tabs={tabs}\n      homepage={false}\n      theme={theme}\n      pageTitle={title}\n      pageDescription={description}\n      pageKeywords={keywords}\n      titleType={titleType}>\n      <PageHeader title={Title ? <Title /> : title} label=\"label\" tabs={tabs} />\n      {tabs && <PageTabs slug={slug} tabs={tabs} currentTab={currentTab} />}\n      <Main padded>\n        {children}\n        <EditLink relativePagePath={relativePagePath} />\n      </Main>\n      <NextPrevious\n        pageContext={pageContext}\n        location={location}\n        slug={slug}\n        tabs={tabs}\n        currentTab={currentTab}\n      />\n      <Utils />\n    </Layout>\n  );\n};\n\nexport default Default;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bxTextTruncateEnd\":\"EditLink-module--bx--text-truncate--end--2pqje\",\"bxTextTruncateFront\":\"EditLink-module--bx--text-truncate--front--3_lIE\",\"link\":\"EditLink-module--link--1qzW3\",\"row\":\"EditLink-module--row--1B9Gk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bxTextTruncateEnd\":\"PageTabs-module--bx--text-truncate--end--267NA\",\"bxTextTruncateFront\":\"PageTabs-module--bx--text-truncate--front--3xEQF\",\"tabsContainer\":\"PageTabs-module--tabs-container--8N4k0\",\"list\":\"PageTabs-module--list--3eFQc\",\"listItem\":\"PageTabs-module--list-item--nUmtD\",\"link\":\"PageTabs-module--link--1mDJ1\",\"selectedItem\":\"PageTabs-module--selected-item--YPVr3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bxTextTruncateEnd\":\"PageHeader-module--bx--text-truncate--end--mZWeX\",\"bxTextTruncateFront\":\"PageHeader-module--bx--text-truncate--front--3zvrI\",\"pageHeader\":\"PageHeader-module--page-header--3hIan\",\"withTabs\":\"PageHeader-module--with-tabs--3nKxA\",\"text\":\"PageHeader-module--text--o9LFq\"};","import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/refarch-eda/refarch-eda/docs/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component '\" + name + \"' was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1>{`Saga`}</h1>\n    <h2>{`Problems and Constraints`}</h2>\n    <p>{`With the adoption of one data source per microservice, there is an interesting challenge on how to support long running transaction cross microservices. With event backbone two phase commit is not an option.`}</p>\n    <h2>{`Solution and Pattern`}</h2>\n    <p>{`Introduced in 1987 `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.cs.cornell.edu/andru/cs711/2002fa/reading/sagas.pdf\"\n      }}>{`by Hector Garcaa-Molrna Kenneth Salem paper`}</a>{` the Saga pattern help to support a long running transaction that can be broken up to a collection of sub transactions that can be interleaved any way with other transactions.`}</p>\n    <p>{`With microservice each transaction updates data within a single service, each subsequent steps may be triggered by previous completion. The following figure, based on `}<a parentName=\"p\" {...{\n        \"href\": \"https://ibm-cloud-architecture.github.io/refarch-kc\"\n      }}>{`our solution implementation`}</a>{`, illustrates those concepts for an order transaction:`}</p>\n    <span {...{\n      \"className\": \"gatsby-resp-image-wrapper\",\n      \"style\": {\n        \"position\": \"relative\",\n        \"display\": \"block\",\n        \"marginLeft\": \"auto\",\n        \"marginRight\": \"auto\",\n        \"maxWidth\": \"1056px\"\n      }\n    }}>{`\n      `}<span parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-background-image\",\n        \"style\": {\n          \"paddingBottom\": \"47.22222222222222%\",\n          \"position\": \"relative\",\n          \"bottom\": \"0\",\n          \"left\": \"0\",\n          \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB6klEQVQoz12RS09TURSF+U1OTBw40IHxNXVi4j9wgDEhKmpoGWiIMYqJRmlDrUGkrQRibQpao6IixVq01lL0ArVUeRVo6e3jPj73vX3QsJJ9Hjtnr7P2Xh0IwrM53JMK7gkFJVekqNYYlHtwZoXht8toukGhVGPkfYaX0Rw+2ctVnflsAe/rRfxTGULCYaHDWvzTWa644lzzfiO9ustWscqlwTn6/D/pfZqwCfOS6xlKcMOXxCG7RRj7lafLHccpb1zh33VC3dAJ9X/h7rkg/RKJyDJNlMoa+7E/Z5omhmG2zrbCN48T3Dwzxq2zL0hH/7YeV9oKm0W7mtEqtu8yHiskUSfU0Qjdj9F9ZJjrx0aYGV/AlOLwwzie7ndEPAmqDVVVVUNJbaJK+01UhURrU2sr/PQ8zaPOCAMS89M5/i3l7Q96jvtwnPRT2FT5k9yg69ATrh59xsWDXpJTWZtkZXEbJbGOJjNtmWKh3GjBgq5rtoqF72uUxV0La9ktW/Xo7SjBezFKOxUmBuboPODh8uEhHCf87Kyr0rKp8WEkxYPzr3BdiKB8XW0Rq3pjXsbeZ8XKnimZHxuMi6Fjd2b5GEhRLJTqhKN9n3GeDuA8FSA+uVRXKcPfFpXtDhq6aed0+cg622ZJ1Nq6+w/pFIJU9DcDxgAAAABJRU5ErkJggg==')\",\n          \"backgroundSize\": \"cover\",\n          \"display\": \"block\"\n        }\n      }}></span>{`\n  `}<img parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-image\",\n        \"alt\": \"1\",\n        \"title\": \"1\",\n        \"src\": \"/refarch-eda/static/a3f8d1f85f507b4c0567fa8d0b61fa87/79f13/saga-ctx.png\",\n        \"srcSet\": [\"/refarch-eda/static/a3f8d1f85f507b4c0567fa8d0b61fa87/7fc1e/saga-ctx.png 288w\", \"/refarch-eda/static/a3f8d1f85f507b4c0567fa8d0b61fa87/a5df1/saga-ctx.png 576w\", \"/refarch-eda/static/a3f8d1f85f507b4c0567fa8d0b61fa87/79f13/saga-ctx.png 1056w\"],\n        \"sizes\": \"(max-width: 1056px) 100vw, 1056px\",\n        \"style\": {\n          \"width\": \"100%\",\n          \"height\": \"100%\",\n          \"margin\": \"0\",\n          \"verticalAlign\": \"middle\",\n          \"position\": \"absolute\",\n          \"top\": \"0\",\n          \"left\": \"0\"\n        },\n        \"loading\": \"lazy\"\n      }}></img>{`\n    `}</span>\n    <p>{`When the order is created, the business process says, we need to allocate a “voyage”, assign containers and update the list of containers to load on the ship. Those actions / commands are chained. The final state (in this schema, not in the reality, as the process has more steps) is the Order assigned state in the order microservice.`}</p>\n    <p>{`With a unique application implementation, the integrity between order, voyage and container tables will be done via transactions. With distributed system we could not apply two phase commit transaction so the Saga pattern will help.`}</p>\n    <p>{`SAGA pattern supports two types of implementation: Choreography and Orchestration.`}</p>\n    <h2>{`Services choreography`}</h2>\n    <p>{`With Choreography each service produces and listens to other service’s events and decides if an action should be taken or not.`}</p>\n    <span {...{\n      \"className\": \"gatsby-resp-image-wrapper\",\n      \"style\": {\n        \"position\": \"relative\",\n        \"display\": \"block\",\n        \"marginLeft\": \"auto\",\n        \"marginRight\": \"auto\",\n        \"maxWidth\": \"1010px\"\n      }\n    }}>{`\n      `}<span parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-background-image\",\n        \"style\": {\n          \"paddingBottom\": \"59.375%\",\n          \"position\": \"relative\",\n          \"bottom\": \"0\",\n          \"left\": \"0\",\n          \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAACpUlEQVQoz11TW08TQRTunzFegg8ajTFqfDD+BN99QJRE1BA1GhOjLz4Roy+AlxgVYgShkdCrvVihlpsB5FraQsvSli4t1IV2d2dndz9nphTEk3zJnjNnvnO+b7KOkqLCNboKz/gaPoWXkcz+wdiijMGRVfQPpzGzXEJ4KgdnNIMvQyvIFncwm97EQGxV1HgvD9u2BRz8wqUHQVx+9B0NN9zoY5cevpvEhXtBnLjpQcfgAq69iOHMnW84dcuL6GweL78u4PRtP062+PC0e1oQmtYu4XxmExfvc8KIIPGMSXj8cRrn7oYYAugKJtHSPs7OQqwvhIm4jA7XEs62BnGe1Z73zwtCq044my7hyrMhMfFokwvO4RW0vprAseseHG4cRKdrEVfbomho9uJ4sxs/5/Jo65vDoUYXjjS58aRr6r8NCwSd0RLe+xNoH5hBPLOF4K8sOt2LeOtbwu9UCcHJHD4E4ugOJVHYqmI8voE3njheexYQm6t5aNU9nE9J+DGVAlEVbi32g3+bOBAm4e4fKFFNA6V072Ecfp8X+awEeWMDBQY+iVILOxUdynaFSbFATQs6JSxXUK2oIIRC0w3oDJpGBFE9HOvrBRDDgCzLSCaTzFwLlmnDME3orK7qOqqajopWhcmIqWGJJXkfzzkZfxCeiw05KyEEqqZie0epNbINhRwmhQ9LplaQljKQC0Xk12QUiyVUVbV2TgwBnXHobLiDExSLRWRzWSZTEVOoYQoISVUCn9eH3t5eOJ1OOPud6PncA0mSdq3el2sYlG9o//MM1p65vMy90nWCWGwEgUAQkUgE4XAYPr8P+Xxe9GZzOYyMjiKRSIitHfVfxrKZVMuAaVMByzaZjwQaUZmXGpNUA8+5RXwbSk0oioIC879cLsNgFvwFDUlUNT1A8oIAAAAASUVORK5CYII=')\",\n          \"backgroundSize\": \"cover\",\n          \"display\": \"block\"\n        }\n      }}></span>{`\n  `}<img parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-image\",\n        \"alt\": \"2\",\n        \"title\": \"2\",\n        \"src\": \"/refarch-eda/static/d2239035da59749331f5e53fdf40e7bb/96101/saga-choreo.png\",\n        \"srcSet\": [\"/refarch-eda/static/d2239035da59749331f5e53fdf40e7bb/7fc1e/saga-choreo.png 288w\", \"/refarch-eda/static/d2239035da59749331f5e53fdf40e7bb/a5df1/saga-choreo.png 576w\", \"/refarch-eda/static/d2239035da59749331f5e53fdf40e7bb/96101/saga-choreo.png 1010w\"],\n        \"sizes\": \"(max-width: 1010px) 100vw, 1010px\",\n        \"style\": {\n          \"width\": \"100%\",\n          \"height\": \"100%\",\n          \"margin\": \"0\",\n          \"verticalAlign\": \"middle\",\n          \"position\": \"absolute\",\n          \"top\": \"0\",\n          \"left\": \"0\"\n        },\n        \"loading\": \"lazy\"\n      }}></img>{`\n    `}</span>\n    <p>{`The first service executes a transaction to its own data store and then publishes an event ( OrderCreated event (1)) as fact about its business entity update. It maintains the business entity status, (order.status) to the `}<inlineCode parentName=\"p\">{`Pending`}</inlineCode>{` state until the saga is completed. This event is listened by one or more services which execute local transactions and publish new events (VoyageAllocated (3), ReeferAssigned (4), PaymentProcessed (5)).\nThe distributed transaction ends when the last service executes its local transaction or when a service does not publish any events or the event published is not polled by any of the saga’s participants. For example, the Order microservice gets all the events from the other service and changed the Order state to be `}<inlineCode parentName=\"p\">{`Accepted`}</inlineCode>{`.`}</p>\n    <p>{`In case of failure, the source microservice is keeping state and timer to monitor for the expected completion events.`}</p>\n    <span {...{\n      \"className\": \"gatsby-resp-image-wrapper\",\n      \"style\": {\n        \"position\": \"relative\",\n        \"display\": \"block\",\n        \"marginLeft\": \"auto\",\n        \"marginRight\": \"auto\",\n        \"maxWidth\": \"974px\"\n      }\n    }}>{`\n      `}<span parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-background-image\",\n        \"style\": {\n          \"paddingBottom\": \"60.416666666666664%\",\n          \"position\": \"relative\",\n          \"bottom\": \"0\",\n          \"left\": \"0\",\n          \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAACmUlEQVQoz12R7U/TUBTG99+oCfpFExLUYDB+wA/+FyrRRCMEBRESNBGNX4x+0ZigJJJhNI7wupW1QNAosg0YEGAvDAplbN3symBbu7aP594FeTnJ6bm39/Z3nvPUlS8YGAtuQQwp6P+5jsimhlVZw8i0DO/MJkIRFeF4BgO/NjD4ewOhqAp9z+Dn4qzC77A9C8dx4Eokc7jeMY4bnZOoahhBt3cV74aWUfvQj8vNfrR9CuHV1zBqGgVcbBrDs945RLY0XGryob5jErXNAmJKjgNtm4AbOzquPZZQ1yrhwn0B7vE43g+v4Pw9H2qa/HjuDuP19yVUPxBoP4YXXxYQJ0BNow9XW8dR3y4hkdw9AkzqqGsRceWRiNM3h/DRF8Gb/iWcujWMs3e8XGFX3zzO3B7BubtedH6e5wqrGoZR3egn1ScUytkCXg5E8dav4ElfBFPhbUjkTUt3AG09IXh+rEMIbNKos2jvmYFnKoFkdg8ddPa0N4gu9zzUXLECZB4qORPfQjsYXC0gonNrcRCWWcTRmJhdx4fBhSNvbDhlE+Vy+fCnsIUgTiCp/sX+fhGGYVZgJD+T0WBZNqXDG83FFILKcGwLhlmGSaC9fAGlUukQaNs2goEAdvXcMTUWvS9R9wJdLhoG9kusWYEZBZNgTBWrrCEb1bKsCpA9HG6ojbX4GmKxGD+oQC1SYSKdyULeVrCbz5MiBjYIZnKFBlW255XSdfAxq9lsFumUCpu6OjSySeM7NrC4sIjR0VGIfpFSgiAICAaDOBklArsOYP+DllaZxiDfjJJJFfgzPQO32w2Px8OTrSVJ4tfZRIlEApqmccXHFFbGP4QzG9gYOV1HKp1GOq1CVVXspFJ8GuZbNBrF8vIKZFnmvv4Dj7dOrkHAgokAAAAASUVORK5CYII=')\",\n          \"backgroundSize\": \"cover\",\n          \"display\": \"block\"\n        }\n      }}></span>{`\n  `}<img parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-image\",\n        \"alt\": \"3\",\n        \"title\": \"3\",\n        \"src\": \"/refarch-eda/static/f816390a3dec9ba2ce7ee15db9611f84/3df5d/saga-choreo-fail.png\",\n        \"srcSet\": [\"/refarch-eda/static/f816390a3dec9ba2ce7ee15db9611f84/7fc1e/saga-choreo-fail.png 288w\", \"/refarch-eda/static/f816390a3dec9ba2ce7ee15db9611f84/a5df1/saga-choreo-fail.png 576w\", \"/refarch-eda/static/f816390a3dec9ba2ce7ee15db9611f84/3df5d/saga-choreo-fail.png 974w\"],\n        \"sizes\": \"(max-width: 974px) 100vw, 974px\",\n        \"style\": {\n          \"width\": \"100%\",\n          \"height\": \"100%\",\n          \"margin\": \"0\",\n          \"verticalAlign\": \"middle\",\n          \"position\": \"absolute\",\n          \"top\": \"0\",\n          \"left\": \"0\"\n        },\n        \"loading\": \"lazy\"\n      }}></img>{`\n    `}</span>\n    <p>{`When a message from any service is missing, the source service, needs to trigger a compensation process:`}</p>\n    <span {...{\n      \"className\": \"gatsby-resp-image-wrapper\",\n      \"style\": {\n        \"position\": \"relative\",\n        \"display\": \"block\",\n        \"marginLeft\": \"auto\",\n        \"marginRight\": \"auto\",\n        \"maxWidth\": \"984px\"\n      }\n    }}>{`\n      `}<span parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-background-image\",\n        \"style\": {\n          \"paddingBottom\": \"60.06944444444444%\",\n          \"position\": \"relative\",\n          \"bottom\": \"0\",\n          \"left\": \"0\",\n          \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAACp0lEQVQoz1WS2U8TURTG+x+5RIwaH+TB6IPGFxMTo0ZjMFGjoJhAgqiRGHGJSyKaGCORWOsDYZG40AIdyqYVBIlIS1tK18wMlOkM7Wx3pp93bi2kZ+Zkcs4993e+c++4pA0dkbSEWCaPvys5yAUdSUFBlMah5DpEqYhoOo8/8Rzml9egFA2WW0pJCNP1lKjAsVKpxNz1JZjE0TscTrRPoLZpCP7ZNG68nsbxe2M42OJHlzeM+ldBHLsbwKGbfkyHBbz5GsaR2xwOt3JofTfLgLb9HzgwlURNwyBqm/040DSM0d8Z1D3/jj3XfNh73YcPwxGcezKJfY1D2N3gxcySiI5Pi9hVP8jiW11z1cD+iRVsv/QZ+xt9FOJlCs9TQE2DDzuveqnCEM48Gmfxtsvf8DMk4EX/AnZcGWTe/PZXNXA8lEOLJ4S2nhgudgQRXFrD/b4oTrb7cfbxOAaCGbR1h1D3NIALzyaxkJDgnsji1AMOpx+O4SVVy4CVM5zLauiel/D+RwZxscgWMwpBQVeck4ZmAfyGAduiayX2IiMTGKZTa6NiDswxV35DhX9qFqJiQFZUlLcAhBYTw3JmYSliEeiaSUOLNbLo1zQJSnap+pYVRUZ/Xw/rVrK3uhk2oRC6iZRdM1So9JfSNYOBCHWL2JvKKuaqJJyiaDSGXC5XhtJHMw0UdQ0CzeVVGYZqQS+S8gS0mWGa0HUDulF2y7K3gDYdbSWegLQulWOLqtRNaKqOUS6AEf8IAtwYc44bBc/zVcocikGhm8DV1VXEYstIJdMILYap0nU6loViQUVvby/cbjc8Hz3weDzo7OxEPB5nIiKRCARBgKqqIIRUK3QO3PladBwnb9ICk5gQRZEp4ulGnheQzWYZoFAoYHpmBolEArIs04uy8Q/0/VG6nRZTyAAAAABJRU5ErkJggg==')\",\n          \"backgroundSize\": \"cover\",\n          \"display\": \"block\"\n        }\n      }}></span>{`\n  `}<img parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-image\",\n        \"alt\": \"4\",\n        \"title\": \"4\",\n        \"src\": \"/refarch-eda/static/1c4248443be55952ef1942206ea1e2ff/2200d/saga-compensation.png\",\n        \"srcSet\": [\"/refarch-eda/static/1c4248443be55952ef1942206ea1e2ff/7fc1e/saga-compensation.png 288w\", \"/refarch-eda/static/1c4248443be55952ef1942206ea1e2ff/a5df1/saga-compensation.png 576w\", \"/refarch-eda/static/1c4248443be55952ef1942206ea1e2ff/2200d/saga-compensation.png 984w\"],\n        \"sizes\": \"(max-width: 984px) 100vw, 984px\",\n        \"style\": {\n          \"width\": \"100%\",\n          \"height\": \"100%\",\n          \"margin\": \"0\",\n          \"verticalAlign\": \"middle\",\n          \"position\": \"absolute\",\n          \"top\": \"0\",\n          \"left\": \"0\"\n        },\n        \"loading\": \"lazy\"\n      }}></img>{`\n    `}</span>\n    <p>{`Rolling back a distributed transaction does not come for free. Normally you have to implement another operation/transaction to compensate for what has been done before. This will be a new event sent by the service responsible of the transaction integrity. In the order example, in the rare case where one of the service is not able to provide a positive response, no voyage found, or no Reefer container found, then the order needs to change to ‘Uncompleted’ status, and an event to the orders topic will claim the orderID is now uncompleted (OrderUncompleted event Step 1 above) . Any service that has something allocated for this orderId will ‘unroll’ their changes in their own data source  (Steps 2,3,4 below).`}</p>\n    <p>{`Also it is important to note, that if one of the service is taking time to answer this may not be a problem as the order is in pending state. If the business requirement stipulates to address an order within a small time period then the compensation process may start. Uncompleted orders can be reviewed by a business user for manual handling. Email can be automatically sent to the customer about issue related to his order. There are a lot of different ways to handle order issue at the business level.`}</p>\n    <h2>{`Services orchestration`}</h2>\n    <p>{`With orchestration, one service is responsible to drive each participant on what to do and when.`}</p>\n    <span {...{\n      \"className\": \"gatsby-resp-image-wrapper\",\n      \"style\": {\n        \"position\": \"relative\",\n        \"display\": \"block\",\n        \"marginLeft\": \"auto\",\n        \"marginRight\": \"auto\",\n        \"maxWidth\": \"1152px\"\n      }\n    }}>{`\n      `}<span parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-background-image\",\n        \"style\": {\n          \"paddingBottom\": \"43.75%\",\n          \"position\": \"relative\",\n          \"bottom\": \"0\",\n          \"left\": \"0\",\n          \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAACFklEQVQoz32SS09TURSF+0/8BcahYUyicWpCYuLAqSEmGkciTIwao2FgQowmxiAqOigOSktr2wsUS9UEUksLAq220FKh9HVbae+j59yP0xYdqftkZY32OmvvtV0dIbE6krbZodK0KekWLVNg2zZtw8Q0LY4Mg7Zl0q2PqRJPfRmW1w95F9nhRfAHW4UG04s7eD7v4ZrwbHPxbpSh+zEeu+NMzKwypeWo1HS0+QXm/AG+Z7PYUig5wcjLr5y64mV85hvnbi8qRPB8KnD6aoBLD2K4xqbWODMcYHAkwuv5LFqyQjBZZ++gTDAUZtbrI5fb4Xc9cm8wcCPEc3+GoXtRLj+MEY7/ZPDWPNeerOC68ybF2eshzo9GePtFJ5yWfEg1yRb2mfP5CIfDWMLG6FjKn6DRalOqNjgyDcqNJhX9F5YtyJdqVPWWEpxWgurHC2MR3KtNonmUYIP9wxrJZIpEIoVeb2K0LSy1544lkLZEqt07wgHZdy6F6LFrdDKh5vczcFNjcrlGMO0wG6+TLx6wtLSErhyo3l5AhgrIMO0em5biE5gqwJZpIqWD69VCjuFnccbdKd7HCnhX9olulCkdltE0jeTaOuntDNV6refA+c/rOczrgpWifbJyB3Fi/aBUxh8IEAqF8Hq97O7m+6NJSa/3L3Ac5bBrUyh02XH+hImhbq8r2lEf7BWLbG5uqZvs32K38V84BgjOfkTtcHjwAAAAAElFTkSuQmCC')\",\n          \"backgroundSize\": \"cover\",\n          \"display\": \"block\"\n        }\n      }}></span>{`\n  `}<img parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-image\",\n        \"alt\": \"5\",\n        \"title\": \"5\",\n        \"src\": \"/refarch-eda/static/69355ff98e61e1225f907e139e86142d/3cbba/saga-ochestration.png\",\n        \"srcSet\": [\"/refarch-eda/static/69355ff98e61e1225f907e139e86142d/7fc1e/saga-ochestration.png 288w\", \"/refarch-eda/static/69355ff98e61e1225f907e139e86142d/a5df1/saga-ochestration.png 576w\", \"/refarch-eda/static/69355ff98e61e1225f907e139e86142d/3cbba/saga-ochestration.png 1152w\", \"/refarch-eda/static/69355ff98e61e1225f907e139e86142d/e129e/saga-ochestration.png 1158w\"],\n        \"sizes\": \"(max-width: 1152px) 100vw, 1152px\",\n        \"style\": {\n          \"width\": \"100%\",\n          \"height\": \"100%\",\n          \"margin\": \"0\",\n          \"verticalAlign\": \"middle\",\n          \"position\": \"absolute\",\n          \"top\": \"0\",\n          \"left\": \"0\"\n        },\n        \"loading\": \"lazy\"\n      }}></img>{`\n    `}</span>\n    <p>{`It uses the different topics to control the saga by issuing event commands to the different service. It uses the event backbone as a queue processing to support the asynchronous invocations. In this case the event should be exactly once delivered and idempotent. Each participant produces response in their context and to the order topic. The orchestration layer needs to keep a state machine and acts once all the expected responses are received.`}</p>\n    <p>{`If anything fails, the orchestrator is also responsible for coordinating the compensation process by sending rollback events with orderID and their respective impacted entity key (voyageID, reeferID, transactionID). Each  participant will undo its previous operations.\nOrchestrator is a State Machine where each transformation corresponds to a command or message.`}</p>\n    <p>{`See also `}<a parentName=\"p\" {...{\n        \"href\": \"https://microservices.io/patterns/data/saga.html\"\n      }}>{`this article`}</a>{` from Chris Richardson on the Saga pattern.`}</p>\n    <p>{`We have implemented the choreography saga pattern in the order management, voyage and refeer management microservices within the `}<a parentName=\"p\" {...{\n        \"href\": \"https://ibm-cloud-architecture.github.io/refarch-kc/implementation/saga-patterns/\"\n      }}>{`EDA reference implementation solution`}</a>{` with a detailed explanation of the integration tests to validate the `}<a parentName=\"p\" {...{\n        \"href\": \"https://ibm-cloud-architecture.github.io/refarch-kc/integration-tests/happy-path/\"\n      }}>{`happy path`}</a>{`, and the `}<a parentName=\"p\" {...{\n        \"href\": \"https://ibm-cloud-architecture.github.io/refarch-kc/integration-tests/saga-pattern/\"\n      }}>{`exception path`}</a>{` with compensation.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}
(window.webpackJsonp=window.webpackJsonp||[]).push([[71,86],{"013z":function(e,t,a){"use strict";var n=a("q1tI"),c=a.n(n),r=a("NmYn"),o=a.n(r),i=a("Wbzz"),s=a("Xrax"),b=a("k4MR"),l=a("TSYQ"),p=a.n(l),m=a("QH2O"),d=a("qKvR"),u=function(e){var t,a=e.title,n=e.tabs,c=void 0===n?[]:n;return Object(d.b)("div",{className:p()(m.pageHeader,(t={},t[m.withTabs]=c.length,t))},Object(d.b)("div",{className:"bx--grid"},Object(d.b)("div",{className:"bx--row"},Object(d.b)("div",{className:"bx--col-lg-12"},Object(d.b)("h1",{id:"page-title",className:m.text},a)))))},h=a("BAC9"),g=function(e){var t=e.relativePagePath,a=e.repository,n=Object(i.useStaticQuery)("1364590287").site.siteMetadata.repository,c=a||n,r=c.baseUrl,o=c.subDirectory,s=r+"/edit/"+c.branch+o+"/src/pages"+t;return r?Object(d.b)("div",{className:"bx--row "+h.row},Object(d.b)("div",{className:"bx--col"},Object(d.b)("a",{className:h.link,href:s},"Edit this page on GitHub"))):null},f=a("FCXl"),O=a("dI71"),j=a("I8xM"),A=function(e){function t(){return e.apply(this,arguments)||this}return Object(O.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.tabs,a=e.slug,n=a.split("/").filter(Boolean).slice(-1)[0],c=t.map((function(e){var t,c=o()(e,{lower:!0,strict:!0}),r=c===n,s=new RegExp(n+"/?(#.*)?$"),b=a.replace(s,c);return Object(d.b)("li",{key:e,className:p()((t={},t[j.selectedItem]=r,t),j.listItem)},Object(d.b)(i.Link,{className:j.link,to:""+b},e))}));return Object(d.b)("div",{className:j.tabsContainer},Object(d.b)("div",{className:"bx--grid"},Object(d.b)("div",{className:"bx--row"},Object(d.b)("div",{className:"bx--col-lg-12 bx--col-no-gutter"},Object(d.b)("nav",null,Object(d.b)("ul",{className:j.list},c))))))},t}(c.a.Component),k=a("MjG9");t.a=function(e){var t=e.pageContext,a=e.children,n=e.location,c=e.Title,r=t.frontmatter,l=void 0===r?{}:r,p=t.relativePagePath,m=t.titleType,h=l.tabs,O=l.title,j=l.theme,N=l.description,w=l.keywords,v=Object(i.useStaticQuery)("2456312558").site.pathPrefix,y=v?n.pathname.replace(v,""):n.pathname,x=h?y.split("/").filter(Boolean).slice(-1)[0]||o()(h[0],{lower:!0}):"";return Object(d.b)(b.a,{tabs:h,homepage:!1,theme:j,pageTitle:O,pageDescription:N,pageKeywords:w,titleType:m},Object(d.b)(u,{title:c?Object(d.b)(c,null):O,label:"label",tabs:h}),h&&Object(d.b)(A,{slug:y,tabs:h,currentTab:x}),Object(d.b)(k.a,{padded:!0},a,Object(d.b)(g,{relativePagePath:p})),Object(d.b)(f.a,{pageContext:t,location:n,slug:y,tabs:h,currentTab:x}),Object(d.b)(s.a,null))}},BAC9:function(e,t,a){e.exports={bxTextTruncateEnd:"EditLink-module--bx--text-truncate--end--2pqje",bxTextTruncateFront:"EditLink-module--bx--text-truncate--front--3_lIE",link:"EditLink-module--link--1qzW3",row:"EditLink-module--row--1B9Gk"}},I8xM:function(e,t,a){e.exports={bxTextTruncateEnd:"PageTabs-module--bx--text-truncate--end--267NA",bxTextTruncateFront:"PageTabs-module--bx--text-truncate--front--3xEQF",tabsContainer:"PageTabs-module--tabs-container--8N4k0",list:"PageTabs-module--list--3eFQc",listItem:"PageTabs-module--list-item--nUmtD",link:"PageTabs-module--link--1mDJ1",selectedItem:"PageTabs-module--selected-item--YPVr3"}},QH2O:function(e,t,a){e.exports={bxTextTruncateEnd:"PageHeader-module--bx--text-truncate--end--mZWeX",bxTextTruncateFront:"PageHeader-module--bx--text-truncate--front--3zvrI",pageHeader:"PageHeader-module--page-header--3hIan",withTabs:"PageHeader-module--with-tabs--3nKxA",text:"PageHeader-module--text--o9LFq"}},rBpE:function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return i})),a.d(t,"default",(function(){return u}));var n=a("wx14"),c=a("zLVn"),r=(a("q1tI"),a("7ljp")),o=a("013z"),i=(a("qKvR"),{}),s=function(e){return function(t){return console.warn("Component '"+e+"' was not imported, exported, or provided by MDXProvider as global scope"),Object(r.b)("div",t)}},b=s("InlineNotification"),l=s("AnchorLinks"),p=s("AnchorLink"),m={_frontmatter:i},d=o.a;function u(e){var t=e.components,a=Object(c.a)(e,["components"]);return Object(r.b)(d,Object(n.a)({},m,a,{components:t,mdxType:"MDXLayout"}),Object(r.b)(b,{kind:"warning",mdxType:"InlineNotification"},Object(r.b)("strong",null,"Updated 11/02/2020")),Object(r.b)(l,{mdxType:"AnchorLinks"},Object(r.b)(p,{mdxType:"AnchorLink"},"Just run it!"),Object(r.b)(p,{mdxType:"AnchorLink"},"Deploy on OpenShift")),Object(r.b)("p",null,"This hands-on lab demonstrates how to use IBM RabbitMQ source connector to inject message to Event Streams On Premise.\nWe are using the ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/ibm-messaging/kafka-connect-rabbitmq-source"}),"IBM messaging github: source Kafka connector for RabbitMQ")," open sourced component. The configuration for this connector is also done using Json config file, with a POST to the Kafka connectors URL."),Object(r.b)("p",null,"The following diagram illustrates the component of this demo / lab:"),Object(r.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"696px"}},"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"54.166666666666664%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAByklEQVQoz42TTW/TQBCG82P5Ixy5cwaEEBLijFSpBQmEqERLqUiE1DSxa2/iGDWNnfhj196Pl5m1XZwbI72a8e7sMzNre+KqClASrpaQeY22YC8BKf06e1PXMJSny4ry6n+ivSMphQkHbNYBzgBZDhRUo1ZAo4FWO4zNOgfDstbHbEMGsx6BqjH4Or1HUVpUpYOsu7Qs1/jwfY23n2K8+xJDtaYDM5DkQQwmHQFbbfErzNA0Fpo6m4YSr89CXM0zvDxd4OmbGZ69/41Kad+TseYROHTpgXxH46F8/YPAt4/nePJ8hvPZfVewcd2m6a5G0zMDuTs3jD7ukBet7TasqrD4+QMi+uPv1o9nDPKiwdlVipOLBJc3Oz/mML6PBqBvd1SNIZLemG4V7Tlow21ZPOwlXpzc4NXpEp+nqYcdDgeUZTkauW3xv8bFZD/RYNvtFgVBuzdLn81us0EkBMRqBcG+V9wrCAIEd3dYko+iCOtk3eX0+Zs0RZIkPrfZ7zHJ6EFwYhwfKaUDG1Jwe4vg8gKL62vEBOa1JBZY9WfYD7FiYJFlqPMcVS+Oy90OEYEEdbUKQwiKo/kcYrn06w80VU2Hh3x/njn0N/0FrexHV3MEoaoAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"0",title:"0",src:"/refarch-eda/static/414eac07528673a0df069d9bdf8ea778/19b24/comp-view.png",srcSet:["/refarch-eda/static/414eac07528673a0df069d9bdf8ea778/7fc1e/comp-view.png 288w","/refarch-eda/static/414eac07528673a0df069d9bdf8ea778/a5df1/comp-view.png 576w","/refarch-eda/static/414eac07528673a0df069d9bdf8ea778/19b24/comp-view.png 696w"],sizes:"(max-width: 696px) 100vw, 696px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),Object(r.b)("p",null,"The configurations used in this use case are in the ",Object(r.b)("inlineCode",{parentName:"p"},"refarch-eda-tools")," repository that you should clone:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"git clone https://github.com/ibm-cloud-architecture/refarch-eda-tools\n")),Object(r.b)("h2",null,"Just run it!"),Object(r.b)("p",null,"For demonstration purpose, we have defined a docker compose file and a set of docker images ready for use. So it will be easier to demonstrate the scenario of sending messages to Rabbit MQ ",Object(r.b)("inlineCode",{parentName:"p"},"items")," queue, have a Kafka connector configured and a simple Kafka consumer which consumes Json doc from the ",Object(r.b)("inlineCode",{parentName:"p"},"items")," Kafka topic. "),Object(r.b)("p",null,"To send message to RabbitMQ, we have implemented a simple store sale simulator, which sends item sale messages for a set of stores. The code is under ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/ibm-cloud-architecture/refarch-eda-store-simulator"}),"eda-store-simulator repository")," and we have also uploaded the image ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/repository/docker/ibmcase/eda-store-simulator"}),"into dockerhub ibmcase/eda-store-simulator"),"."),Object(r.b)("h3",null,"Start backend services"),Object(r.b)("p",null,"To quickly start a local demonstration environment, the ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/ibm-cloud-architecture/refarch-eda-tools"}),"github repository for this lab")," includes a ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/ibm-cloud-architecture/refarch-eda-tools/tree/master/labs/rabbitmq-source-lab/docker-compose.yaml"}),"docker compose file")," under the ",Object(r.b)("inlineCode",{parentName:"p"},"labs/rabbitmq-source-lab")," folder."),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),'git clone https://github.com/ibm-cloud-architecture/refarch-eda-tools\ncd refarch-eda-tools/labs/rabbitmq-source-lab\ndocker-compose up &\ndocker ps \n\nIMAGE                              COMMAND                   PORT                  \nibmcase/kconnect:v1.0.0            "./bin/connect-distr…"    0.0.0.0:8083->8083/  \nstrimzi/kafka:latest-kafka-2.6.0   "sh -c \'bin/kafka-se…"    0.0.0.0:9092->9092/\nibmcase/eda-store-simulator        "/deployments/run-ja…"    0.0.0.0:8080->8080/\nrabbitmq:3-management              "docker-entrypoint.s…"    0.0.0.0:5672->5672/tcp, 15671/tcp, 15691-15692/tcp, 25672/tcp, 0.0.0.0:15672->15672/tcp   \nstrimzi/kafka:latest-kafka-2.6.0   "sh -c \'bin/zookeepe…"    0.0.0.0:2181->2181/                                                                                      \n')),Object(r.b)("h3",null,"Deploy source connector"),Object(r.b)("p",null,"Once the different containers are started, you can deploy the RabbitMQ source connector using the following POST"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),'# under the folder\ncurl -X POST -H "Content-Type: application/json" http://localhost:8083/connectors   --data "@./rabbitmq-source.json\n')),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"And then looking at the deployed connectors using ",Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"http://localhost:8083/connectors"}),"http://localhost:8083/connectors")," or the RabbitMQ connector with ",Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"http://localhost:8083/connectors/RabbitMQSourceConnector"}),"http://localhost:8083/connectors/RabbitMQSourceConnector"),".")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{}),"")),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Send some records using the simulator at the ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"http://localhost:8080/#/simulator"}),"http://localhost:8080/#/simulator")," URL and the user interface: "),Object(r.b)("span",Object(n.a)({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"50%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABNElEQVQoz41R20rEMBDtr6lPXlYQX/0Gv0RBV1/22b/wP9y1iIsIoiAsZWmbZHI5zqSNzWpdHDhMMpczZ5LidPaMybTE8fQRB1dz7F+X2L1cYOdizlhkGO57nD/inslNiZPbEud3S5zNnnDIsUKRg7YeH58rvLy+YVWtoYyF4ZhA9955PkstdV79QIoV6E1pgtYKzlp47xCYILAHPMgFvFeE/1gRQoCAjIFSiqGjb9s2whgdCauGB3Gd87/hfcchiArlsN0CLBEsqx9qQw98k0WFeSBP5IMsK7h/qLBWro9v5v8kTOe6ruO6ea41Lq48NnwroefPEMKmaeKKxKtSXLcDkYVzLmKMfFSh1joqFCJpFGLNnyZ3GSiQeP40G4RJWZqcVA3qbBwgv2+Y2PTkqV56k30Bx+L8kvlZVVEAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"1",title:"1",src:"/refarch-eda/static/f2928e432cdc42581a42938ce766293e/3cbba/store-simul-rmq.png",srcSet:["/refarch-eda/static/f2928e432cdc42581a42938ce766293e/7fc1e/store-simul-rmq.png 288w","/refarch-eda/static/f2928e432cdc42581a42938ce766293e/a5df1/store-simul-rmq.png 576w","/refarch-eda/static/f2928e432cdc42581a42938ce766293e/3cbba/store-simul-rmq.png 1152w","/refarch-eda/static/f2928e432cdc42581a42938ce766293e/2e899/store-simul-rmq.png 1370w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "))),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Verify the RabbitMQ settings")),Object(r.b)("p",null,"In a Web Browser go to ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"http://localhost:1567/"}),"http://localhost:1567/")," using the rabbit-user/rabbit-pass login."),Object(r.b)("p",null,"You should reach this console:"),Object(r.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}},"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"40.27777777777778%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABKElEQVQoz31SYW+CMBTs//89+7BvS7YlikwSgptiw4bgYICgooBA4dY2wFime8n1tX3NvXuXEuy3QEjB0giXskRVVTifMzDGMI62bf9ARF0zZFmGPM9RFAXIm67h4f4Ox2THic5I03SAeNQ/bppGNrkGUetBgjACtd6RFxepruxUitxDnG+R1XX9CyTjqvZJgjiOcTqdBiXjrmK88fk/EDHm4XCQo92Ka/7dArFtG6qqwjRNCcMwsFqtJHzfRxRFA+kPudwMd11buRLHcaDrOizLwpquJRGlVO4935OEvYci10x4VaHifjE+Ytn5LfwTdWJvuEJFxcJZQAkVLBKevxQsd0vMPmfQAg0Td4J5MMfUnUINXrBxP2C6HtbxEdrrEs9Pj1KU+Dbf2ghlXX/GZDoAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"7",title:"7",src:"/refarch-eda/static/4ef70acaeaa0ffa5c8bfa7425adac422/3cbba/rabbitmq-overview.png",srcSet:["/refarch-eda/static/4ef70acaeaa0ffa5c8bfa7425adac422/7fc1e/rabbitmq-overview.png 288w","/refarch-eda/static/4ef70acaeaa0ffa5c8bfa7425adac422/a5df1/rabbitmq-overview.png 576w","/refarch-eda/static/4ef70acaeaa0ffa5c8bfa7425adac422/3cbba/rabbitmq-overview.png 1152w","/refarch-eda/static/4ef70acaeaa0ffa5c8bfa7425adac422/0b124/rabbitmq-overview.png 1728w","/refarch-eda/static/4ef70acaeaa0ffa5c8bfa7425adac422/25a1a/rabbitmq-overview.png 2000w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),Object(r.b)("p",null,"Go to the Queue tab and select the ",Object(r.b)("inlineCode",{parentName:"p"},"items")," queue:"),Object(r.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}},"\n      ",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"28.819444444444443%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAvklEQVQY06VQ0QqDMAz0/79tb744RPFBO2utRVBBbXvzAgVh29MCR3qX5EiaFUUBpRTO84T3/m9kfd9jnmccx4EQwkdDjPGr/tPQWott27Cuq+Q0nLJzTmo0vgd5wl3L2JzOjcFTlgI33vddajRnMN95iruW1XWNcRyxLAuUnaD0ADdNaJoGVVXBGCN/PF0avyfPc5RlCa21cC5EcAEx5GDXtldR49EZPLsX1MWHYRAzDtGQBtQIvhPYw0vSyW/Q7dBTuixYFAAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(n.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"9",title:"9",src:"/refarch-eda/static/608e809e882493e3f37f0bade964d0e1/3cbba/rabbitmq-item-queue-2.png",srcSet:["/refarch-eda/static/608e809e882493e3f37f0bade964d0e1/7fc1e/rabbitmq-item-queue-2.png 288w","/refarch-eda/static/608e809e882493e3f37f0bade964d0e1/a5df1/rabbitmq-item-queue-2.png 576w","/refarch-eda/static/608e809e882493e3f37f0bade964d0e1/3cbba/rabbitmq-item-queue-2.png 1152w","/refarch-eda/static/608e809e882493e3f37f0bade964d0e1/46052/rabbitmq-item-queue-2.png 1382w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Now verify the Kafka connect-* topics are created successfully:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),'docker run -ti --network kafkanet strimzi/kafka:latest-kafka-2.6.0 bash -c "/opt/kafka/bin/kafka-topics.sh --bootstrap-server kafka:9092 --list"\n# you should get at least\n__consumer_offsets\nconnect-configs\nconnect-offsets\nconnect-status\nitems\n'))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Verify the message arrived to the ",Object(r.b)("inlineCode",{parentName:"p"},"items")," in kafka topic:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),'docker run -ti --network kafkanet strimzi/kafka:latest-kafka-2.6.0 bash -c "/opt/kafka/bin/kafka-console-consumer.sh --bootstrap-server kafka:9092 --topic items --from-beginning"\n\n# You may have a trace like which maps the messages sent \n"{\\"id\\":0,\\"price\\":11.0,\\"quantity\\":6,\\"sku\\":\\"Item_5\\",\\"storeName\\":\\"Store_3\\",\\"timestamp\\":\\"2020-10-23T19:11:26.395325\\",\\"type\\":\\"SALE\\"}"\n"{\\"id\\":1,\\"price\\":68.5,\\"quantity\\":0,\\"sku\\":\\"Item_5\\",\\"storeName\\":\\"Store_1\\",\\"timestamp\\":\\"2020-10-23T19:11:26.395447\\",\\"type\\":\\"SALE\\"}"\n')))),Object(r.b)("p",null,"You validated the solution work end to end. Now we can try to deploy those components to OpenShift."),Object(r.b)("h2",null,"Deploy on OpenShift"),Object(r.b)("p",null,"In this section, we want to run and deploy the connector and Rabbit MQ on OpenShift using Event Streams on Premise."),Object(r.b)("h3",null,"Pre-requisites"),Object(r.b)(b,{kind:"warning",mdxType:"InlineNotification"},Object(r.b)("strong",null,"TODO")),Object(r.b)("p",null,Object(r.b)("em",{parentName:"p"},"Pull in necessary pre-req from the ",Object(r.b)("a",Object(n.a)({parentName:"em"},{href:"/refarch-eda/scenarios/realtime-inventory/#general-pre-requisites"}),"Realtime Inventory Pre-reqs"),", like for example the deployment of the store simulator.")),Object(r.b)("h3",null,"Deploy RabbitMQ using operators"),Object(r.b)("p",null,"See ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.rabbitmq.com/kubernetes/operator/install-operator.html"}),"the installation instructions")," to get a RabbitMQ ",Object(r.b)("strong",{parentName:"p"},"operator")," installed, or use our manifests from the ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/ibm-cloud-architecture/refarch-eda-tools"}),"refarch-eda-tools")," repository, which will set user 1000 and 999 for OpenShift deployment."),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Create a dedicated project to run RabbitMQ operator to observe any projects, and install CRD, service account, RBAC role, deployment… ")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"oc new-project rabbitmq-system\n# under the labs/rabbitmq-source-lab folder do\nkubectl apply -f cluster-operator.yml\n\nkubectl get customresourcedefinitions.apiextensions.k8s.io\n")),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Create a project for RabbitMQ cluster. It is recommended to have separate project for RabbitMQ cluster.\nModify the namespace to be able to deploy RabbitMQ cluster into it. So we need to get user 999 authorized:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"})," oc edit namespace rabbitmq-cluster\n # Then add the following annotations:\n annotations:\n   openshift.io/sa.scc.supplemental-groups: 999/1\n   openshift.io/sa.scc.uid-range: 999/1\n")),Object(r.b)("p",{parentName:"li"}," Or use our custom  ",Object(r.b)("inlineCode",{parentName:"p"},"oc apply -f rmq-cluster.yaml")))),Object(r.b)("h2",null,"Configure the kafka connector for Rabbitmq source"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"rabbitmq-source.json")," define the connector and the RabbitMQ connection parameters:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-json"}),'{\n    "name": "RabbitMQSourceConnector",\n    "config": {\n        "connector.class": "com.ibm.eventstreams.connect.rabbitmqsource.RabbitMQSourceConnector",\n        "tasks.max": "1",\n        "kafka.topic" : "items",\n        "rabbitmq.host": "rabbitmq",\n        "rabbitmq.queue" : "items",\n        "rabbitmq.prefetch.count" : "500",\n        "rabbitmq.automatic.recovery.enabled" : "true",\n        "rabbitmq.network.recovery.interval.ms" : "10000",\n        "rabbitmq.topology.recovery.enabled" : "true"\n    }\n}\n')),Object(r.b)("p",null,"This file is uploaded to Kafka Connect via a PORT operation:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),'curl -X POST -H "Content-Type: application/json" http://localhost:8083/connectors   --data "@./rabbitmq-source.json"\n')),Object(r.b)("p",null,"To verify use: ",Object(r.b)("inlineCode",{parentName:"p"},"curl -X GET http://localhost:8083/connectors"),"."),Object(r.b)("p",null,"In Kafka connect trace you should see:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"[Worker clientId=connect-1, groupId=eda-kconnect] Connector RabbitMQSourceConnector config updated\n...\nStarting connector RabbitMQSourceConnector\n...\n Starting task RabbitMQSourceConnector-0\n\n")),Object(r.b)("p",null,"And Rabbitmq that get the connection from Kafka Connect."),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"rabbitmq_1  [info] <0.1766.0> accepting AMQP connection <0.1766.0> (172.19.0.3:33040 -> 172.19.0.2:5672)\nkconnect_1  INFO Creating Channel (com.ibm.eventstreams.connect.rabbitmqsource.RabbitMQSourceTask:61)\nrabbitmq_1  connection <0.1766.0> (172.19.0.3:33040 -> 172.19.0.2:5672): user 'rabbit-user' authenticated and granted access to vhost '/'\n")))}u.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-use-cases-connect-rabbitmq-index-mdx-88f510755de3fda03c7f.js.map